<html>
    <head>
        <title> Hello leaderboard </title>
    </head>

    <body>
        <h1>Leaderboard</h1>

        <div id="leaderboard"> 
            <table class="generaltable" style="width:50%" id="SETleaderboard">
            </table> 
        </div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sheetrock/1.1.4/dist/sheetrock.min.js"></script>

<script type="text/javascript">
var mySpreadsheet = 'https://docs.google.com/spreadsheets/d/1o7Dqv8XK54yVrvAmbJvsf88ot2QssSxUMJM4wP8q204/edit#gid=0';

var myRowTemplate = function( row ) {
    rowString = "";
    rowClass = '';
    if ( row.cells.Current == 'yes' ) {
        rowClass= 'color: #FF2222';
    }

    rowString = '<tr style="' + rowClass + '">';
    rowString += "  <td> " + row.num++ + " </td>"; 
    rowString += "  <td> " + row.cells.Year + " </td> ";
    rowString += "  <td> " + row.cells.Responses + " </td>";
    rowString += "  <td> " + row.cells.Percentage + " </td>";
    rowString += "</tr>";

    return rowString
}

$('#SETleaderboard').sheetrock({
  url: mySpreadsheet,
  query: "select A,B,C,D order by C desc",
  rowTemplate: myRowTemplate
});


</script></div>
