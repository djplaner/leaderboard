<html>
    <head>
        <title> Hello leaderboard </title>
    </head>

    <body>
        <h1>Leaderboard</h1>

            <table class="generaltable" style="width:50%" id="SETleaderboard">
            </table> 

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sheetrock/1.1.4/dist/sheetrock.min.js"></script>

<script type="text/javascript">
var mySpreadsheet = 'https://docs.google.com/spreadsheets/d/1o7Dqv8XK54yVrvAmbJvsf88ot2QssSxUMJM4wP8q204/edit#gid=0';

var myRowTemplate = function( row ) {
    if ( row.num ==0 ) {
        return ' <tr> <th style="text-align:right"> Rank </th> <th style="text-align:right"> Year </th> <th style="text-align:right"> Responses </th> <th style="text-align:right"> Percentage </th> </tr> '
    }
    rowString = "";
    rowClass = '';
    if ( row.cells.Current == 'yes' ) {
        rowClass= 'color: #FF2222';
    }

    num = row.num++;
    rowString = '<tr style="' + rowClass + '">';
    rowString += '  <td style="text-align:right"> ' + num + ' </td>'; 
    rowString += '  <td style="text-align:right"> ' + row.cells.Year + ' </td> ';
    rowString += '  <td style="text-align:right"> ' + row.cells.Responses + ' </td>';
    rowString += '  <td style="text-align:right"> ' + row.cells.Percentage + ' </td>';
    rowString += '</tr>';

    return rowString
}

    leaderboard = document.getElementById("SETleaderboard")

    sheetrock({ 
        target: leaderboard,
        url: mySpreadsheet, query: "select A,B,C,D order by C desc", 
        rowTemplate: myRowTemplate, 
    });
</script></div>
